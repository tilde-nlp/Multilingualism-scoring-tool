<!DOCTYPE html>
<html lang="en" data-adreal-did="1620292041587186"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.80.0">
    <title>Multilingualism tool</title>


    

    <!-- Bootstrap core CSS -->
<!-- <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet"> -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">

<meta name="theme-color" content="#563d7c">

<style>
    #start-crawling {
      background-color: #A41E43;
      border: 1px solid #A41E43;
    }

    .crawling-data__wrapper .strong {
      font-weight: 600;
    }

    .status-alert {
      display: none;
    }

    .status-alert img {
      height: 32px;
    }

    .crawling-stats {
      display: none;
    }

    #download_results_wrapper {
      display: none;
    }

    .inline-logo {
      height: 30px;
    }
</style>

</head>
  <body class="bg-light">
    
<div class="container">
  <div class="py-5 text-center">
    <img class="d-block mx-auto mb-4" src="/images/elrc.png" alt="" width="100" height="100">
    <h2>Multilingualism Scoring Tool.</h2>
    <p class="lead">Below is a multilinguality tool developed by Tilde. </p>
  </div>

  <div class="row crawling-data">

    <div class="col-md-10 offset-1">
      <div class="alert alert-secondary justify-content-between align-items-center status-alert" role="alert">
        <img src="/images/loader.gif" alt="">
        Crawling is ongoing.
        <!-- <a href="#" class="mr-2 refresh-stats" type="submit">Refresh</a> -->
        <a  href="#" class="stop-crawl" type="submit">Stop</a>
      </div>

      <div class="alert alert-secondary justify-content-between align-items-center done-alert" role="alert">
        Crawling finished.
       </div>

      <h4 class="mb-3">Crawling data</h4>
      <form id="crawling-form" class="needs-validation" novalidate="">
        <div class="row">
          <div class="col-md-12 mb-3">
            
            <div class="form-group">
              <label for="exampleFormControlTextarea1">Urls (each in new line):</label>
              <textarea class="form-control" id="urlsToCrawl" rows="5"></textarea>
            </div>
            </div>
        </div>


        <div class="row">
          <div class="col-md-3 mb-3">
            <label for="zip">Crawling depth:</label>
            <input type="number" value="1" class="form-control" min="0" max="999" id="hops" placeholder="0" required="">
          </div>
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="zip">Job name:</label>
            <input type="text" class="form-control" id="titleOfJob" placeholder="" required="">
            <small>Alphanumeric symbols only</small>
          </div>
        </div>

        
        <hr class="mb-4">
        <button class="btn btn-primary btn-lg btn-block" id="start-crawling" type="submit">Start crawling</button>
      </form>
    </div>
  </div>

  <div class="col-md-10 offset-1" id="latest_results_wrapper">
    <a href="#" id="latest_results">Get latest results</a>
</div>

  <div class="row crawling-stats">
    <div class="col-md-10 offset-1">
      <h4 class="mb-5 mt-5">Current crawl data</h4>

      <table class="table table-sm crawling-data">
        <thead>
          <tr>
            <th scope="col">Url</th>
            <th scope="col">Normalised Language balance</th>
            <th scope="col">LDI_pages</th>
            <th scope="col">LDI_words</th>
            <th scope="col">Language count</th>
            <th scope="col">Languages</th>
            <th scope="col">Words per language</th>
            <th scope="col">Total pages</th>
            <th scope="col">Total words</th>
            <th scope="col">Pages w/o language</th>
            <th scope="col">Words in pages w/o language</th>
          </tr>
        </thead>
        <tbody>
          
        </tbody>
      </table>
    </div>
  </div>

  <div class="col-md-10 offset-1" id="download_results_wrapper">
      <hr class="mb-4">
      <a href="score?q=download_results">Download results</a>
  </div>

  <footer class="my-5 pt-5 text-muted text-center text-small">
    <p class="mb-1">Â© 2021 Tilde <img class="inline-logo" src="https://tilde.com/themes/custom/drupal8_zymphonies_theme/logo.svg" alt=""> </p>
    <!-- <ul class="list-inline">
      <li class="list-inline-item"><a href="#">Privacy</a></li>
      <li class="list-inline-item"><a href="#">Terms</a></li>
      <li class="list-inline-item"><a href="#">Support</a></li>
    </ul> -->
  </footer>
</div>


<script
src="https://code.jquery.com/jquery-3.6.0.min.js"
integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
crossorigin="anonymous"></script>
      <script>window.jQuery || document.write('<script src="/docs/4.6/assets/js/vendor/jquery.min.js"><\/script>')</script>
      <!-- <script src="bootstrap/js/bootstrap.bundle.min.js"></script> -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns" crossorigin="anonymous"></script>

      <script>
              $(document).ready(function() {
                var handle = 0;
                var crawling_in_progress = 0;
                //var serverUrl = "http://127.0.0.127:8989";
                var serverUrl = "";

                  var get_crawl_progress_status = function(){
                    const url = serverUrl + "/score?q=get_crawl_progress_status";
                      $.ajax({
                            type: "POST",
                            url: url,
                            // data: {urls: urlsToCrawl, hops: hops},
                            success: ((res)=>{
                              res = JSON.parse(res);
                              if (res.status === "error") {
                                clearInterval(handle); 
                                handle = 0;
                                crawling_in_progress = 0;
                                $(".status-alert").hide();
                                $(".done-alert").hide();
                                $("#crawling-form :input").prop("disabled", false);
                              } else if(res.status === "ready") {
                                  // crawling finished
                                  clearInterval(handle); 
                                  handle = 0;
                                  $(".status-alert").hide();
                                  $(".done-alert").hide();
                                  crawling_in_progress = 0;
                                  $("#crawling-form :input").prop("disabled", false);
                              } else if(res.status === "stopping") {
                                  $(".status-alert").show();
                                  $(".done-alert").hide();
                                  crawling_in_progress = 1;
                                  $("#crawling-form :input").prop("disabled", true);
                                  clearInterval(handle); 
                                  handle = 0;
                                  refresh_stats();
                              } else {
                                // crawling
                                crawling_in_progress = 1;
                                $("#crawling-form :input").prop("disabled", true);
                                $(".status-alert").show();
                                $(".done-alert").hide();
                                refresh_stats();
                                if(handle === 0) {
                                  startInterval();
                                }
                              }
                            })
                      });
                  };

                  var refresh_stats = function(){ 
                    const url = serverUrl + "/score?q=get_current_scores";

                      $.ajax({
                            type: "POST",
                            url: url,
                            success: ((res)=>{
                              res = JSON.parse(res);
                              if(res.status !== "error") {
                                let resultPages = [];
                                for (const [key, value] of Object.entries(res)) {
                                  const tempPage = [key, ...res[key]];
                                  resultPages.push(tempPage);
                                }
                                // create table and show stats
                                let dataTable = "";
                                resultPages.forEach((dataRow)=>{
                                  let tablerow = "<tr>";
                                  tablerow += "<th scope='row'>"+dataRow[0]+"</th>";
                                  tablerow += "<td>"+dataRow[1]+"</td>";
                                  tablerow += "<td>"+dataRow[2].LDI_pages+"</td>";
                                  tablerow += "<td>"+dataRow[2].LDI_words+"</td>";
                                  tablerow += "<td>"+dataRow[2].lang_count+"</td>";
                                  tablerow += "<td>";
                                    for (const [key, value] of Object.entries(dataRow[2].langs)) {
                                      tablerow += "<span>"+key+":</span> <span>"+value+"</span><br>";
                                    }
                                    tablerow += "</td>";
                                  
                                    tablerow += "<td>"
                                      
                                      // if (dataRow[2].langs_words) {
                                        for (const [key, value] of Object.entries(dataRow[2].langs_words)) {
                                      tablerow += "<span>"+key+":</span> <span>"+value+"</span><br>";
                                    }
                                      // }
                                    
                                      
                                      
                                      tablerow += "</td>";
                                    tablerow += "<td>"+dataRow[2].total_pages+"</td>";
                                    tablerow += "<td>"+dataRow[2].total_words+"</td>";
                                    tablerow += "<td>"+dataRow[2].wo_lang_pages+"</td>";
                                    tablerow += "<td>"+dataRow[2].wo_lang_words+"</td>";
                                  tablerow += "</tr>";

                                  dataTable += tablerow;
                                });

                                $(".crawling-data tbody").html("");

                                $(".crawling-data tbody").append(dataTable);

                                // get_crawl_progress_status();
                                $(".crawling-stats").show();
                                $("#download_results_wrapper").show();
                              } else {
                                // scoring tool not running
                                $(".crawling-stats").hide();
                                $("#download_results_wrapper").hide();
                              }
                            })
                          });
                  }

                  get_crawl_progress_status();

                  var startInterval = function(){
                    handle = setInterval(function(){ 
                      get_crawl_progress_status();
                    }, 5000);
                  }

                    $("#start-crawling").on("click", ((event)=>{
                      event.preventDefault();
                      $("#crawling-form :input").prop("disabled", true);
                      const url = serverUrl + "/score?q=start_crawl";
                      const urlsToCrawl = $("#urlsToCrawl").val();
                      const hops = $("#hops").val();
                      const titleOfJob = $("#titleOfJob").val(); 
                      $.ajax({
                              type: "POST",
                              url: url,
                              data: {urls: urlsToCrawl, hops: hops, titleOfJob:titleOfJob},
                              success: ((res)=>{
                                get_crawl_progress_status();
                                if(handle === 0) {
                                  startInterval();
                                }
                              })
                            });

                    }));

                    $(".stop-crawl").on("click", ((event)=>{
                      event.preventDefault();
                      const url = serverUrl + "/score?q=stop_crawl";
                      $.ajax({
                              type: "POST",
                              url: url,
                              success: ((res)=>{
                                // get_crawl_progress_status();
                              })
                            });

                    }));


                    // $(".refresh-stats").on("click", ((event)=>{
                    //   event.preventDefault();
                    //   refresh_stats();

                    // }));

                    $("#latest_results").on("click", ((event)=>{
                      event.preventDefault();
                      refresh_stats();

                    }));

                    //latest_results
              });

      </script>
        
  </body></html>